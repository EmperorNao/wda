
# Web document analysis

Проект по соревнованию на [kaggle](https://www.kaggle.com/competitions/anomaly-detection-competition-ml1-ts-autumn-2023/overview)


## Подготовка

1. Кладём в репозиторий данные в нужном формате:
```
data/  
    sample_submission.csv
    test_groups.csv  
    train_groups.csv
    docs_titles.tsv
    content/
           {^[0-9]+$}.dat
```

2. Меняем константы в [constants.py](./constants.py)


# Бейзлайны 


## Бейзлайны основанные на обработке только данных с title'ов 

[Препроцессим](pipelines%2Ftitles_preprocessing.py) простые данные (лейблов), 
аккуратно склеиваем с train + test групами, складываем в отдельный csv-шник итоговый джойн
чтобы его таскать и не тратить время на обработку. 

### SVM по title'ам

Идея: берём все тайтлы и создаём из них корпус, 
делаем TfIdf + TruncatedSVD на весь корпус, учим SVM.

#### метрики SVM по кросс-валидации
[Скрипт](./pipelines/svm/svm_titles_crossval.py) для кросс-валидации

| n_components | C in SVM | F1 on test          | F1 on train         |
|--------------|----------|---------------------|---------------------|
| 25           | 0.001    | 0.1727165832555488  | 0.26558814786900126 | 
| 25           | 0.01     | 0.5507886073712388  | 0.5599226853856151  | 
| 25           | 0.1      | 0.5969171351541723  | 0.6291994631395694  | 
| 25           | 1        | 0.5914141817410241  | 0.6577506589845903  | 
| 25           | 10       | 0.5419218536647635  | 0.712141936449977   | 
| 25           | 100      | 0.48676789722403857 | 0.7731278239493349  | 
| 25           | 1000     | 0.4630610033823933  | 0.8327784631757436  | 
| 50           | 0.001    | 0.4168354126232332  | 0.44551033578408583 | 
| 50           | 0.01     | 0.5723693878513292  | 0.5869101378712435  | 
| 50           | 0.1      | 0.6213041793126965  | 0.6561208528346018  | 
| 50           | 1        | 0.5793823857413047  | 0.6977104334062287  | 
| 50           | 10       | 0.43690059195108244 | 0.7792737614744663  | 
| 50           | 100      | 0.409404686320533   | 0.8487370409377979  | 
| 50           | 1000     | 0.4075340394619393  | 0.9073619180899415  | 
| 100          | 0.001    | 0.45634759657878166 | 0.4819992021978008  | 
| 100          | 0.01     | 0.5733033811696291  | 0.5874027125694135  | 
| 100          | 0.1      | 0.6327322622390879  | 0.6803251258184246  | 
| 100          | 1        | 0.5574859092635098  | 0.7434683961379955  | 
| 100          | 10       | 0.42872079408824415 | 0.8397432657214761  | 
| 100          | 100      | 0.3769822275059318  | 0.9023168660075918  | 
| 100          | 1000     | 0.35071819917120395 | 0.9498520270933983  | 
| 150          | 0.001    | 0.45375726002972067 | 0.4834670200756072  | 
| 150          | 0.01     | 0.5741441242430411  | 0.5885050093388922  | 
| 150          | 0.1      | 0.6315994762653379  | 0.6983875270340908  | 
| 150          | 1        | 0.5264664487316886  | 0.7721402985320639  | 
| 150          | 10       | 0.38931853363051216 | 0.867838783812425   | 
| 150          | 100      | 0.36213932578755936 | 0.9310985044848111  | 
| 150          | 1000     | 0.318809231340324   | 0.9664471040834004  | 
| 200          | 0.001    | 0.43432405030235177 | 0.46864506641655057 | 
| 200          | 0.01     | 0.573241027000172   | 0.5879818156792811  | 
| 200          | 0.1      | 0.6278410646675827  | 0.706312052380532   | 
| 200          | 1        | 0.4914551295121736  | 0.7907358731003925  | 
| 200          | 10       | 0.36573034931578297 | 0.8939676541971261  | 
| 200          | 100      | 0.35506804299471345 | 0.9463537246631006  | 
| 200          | 1000     | 0.3240737533687806  | 0.9755764270292963  | 
| 250          | 0.001    | 0.41277245158768705 | 0.4522942569425242  | 
| 250          | 0.01     | 0.5727866938977269  | 0.5894002591861673  | 
| 250          | 0.1      | 0.6292876746939463  | 0.7129713967724246  | 
| 250          | 1        | 0.46511629693158196 | 0.8037445333412603  | 
| 250          | 10       | 0.3758811417190343  | 0.9115866801329512  | 
| 250          | 100      | 0.34176853508033345 | 0.9579368033526248  | 
| 250          | 1000     | 0.3129933027808761  | 0.9807787955721367  | 
| 500          | 0.001    | 0.12340518186759937 | 0.20674355068118536 | 
| 500          | 0.01     | 0.5720749683181822  | 0.5880930935376105  | 
| 500          | 0.1      | 0.6302440457621203  | 0.7315263176885379  | 
| 500          | 1        | 0.3800173486934924  | 0.85166184105965    | 
| 500          | 10       | 0.28864728518832494 | 0.9512706892940888  | 
| 500          | 100      | 0.3032920288280881  | 0.9798051893743253  | 


#### Предикт при разных параметрах на test-сете

| k   | C   | Kaggle F1 score |
|-----|-----|-----------------|
| 100 | 0.1 | 0.62736         |
| 50  | 1   |                 |



## Бейзлайны основанные на использовании расширенной информации
 <...>